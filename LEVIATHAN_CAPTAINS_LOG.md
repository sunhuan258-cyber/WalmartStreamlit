
# 《利维坦》航海日志 (v3.0)

**最后更新**: 2025年10月5日

---

## 1. 当前状态与下一步行动 (Current Status & Next Action)

- **已完成阶段**: 
  - **[完成] 阶段0 & 1: 基建与本地核心**
  - **[完成] 阶段2: “神谕” - 自然语言查询模块**
  - **[完成] 阶段3.1: 描述性与诊断性分析模块 (“洞察者” & “店铺深度剖析”)**

- **当前所处阶段**: 
  - **--> 阶段3.2: 预测性分析模块 (“先知”)**

- **下一步具体任务**: 
  - 在“先知 (The Prophet)”Tab中，**加载**我们预先训练好的机器学习模型 `lightgbm_model.joblib`。

---

## 2. 执行背景与最高指令 (Execution Background & Supreme Directive)

- **最高指令**: **“我爆肝加时间做都行，但是它得是一个强大的，而不是阉割的产物。”** —— 本项目所有决策的最终裁定标准。

---

## 3. 项目核心目标与要求 (Core Objectives & Requirements)

我们的最终交付物，是一个名为“利维坦”的、部署在公网的、企业级一体化AI数据分析平台Demo。它必须包含以下核心功能模块：

1.  **神谕 (The Oracle) - 自然语言查询**: **[已完成]**
2.  **洞察者 (The Seer) - 全局可视化分析**: **[已完成]**
3.  **店铺深度剖析 (Store Deep-Dive) - 单店定制化分析**: **[已完成]**
4.  **先知 (The Prophet) - 机器学习预测**: **[待开发]**
5.  **解剖者 (The Anatomist) - AI可解释性**: **[待开发]**
6.  **系统信息 (System Info)**: **[待开发]**

---

## 4. 技术栈选型 (Technology Stack)

- **前端展示**: Streamlit + Plotly
- **核心数据库**: DuckDB
- **AI & ML核心**:
    - **语言理解**: LangChain (Text-to-SQL)
    - **机器学习**: LightGBM, Scikit-learn, Joblib
    - **本地大模型**: Ollama + qwen3:30b
- **云端部署**: Streamlit Community Cloud

---

## 5. 详细作战阶段 (Detailed Battle Phases)

#### **阶段 0 & 1: 基建与本地核心**
- **状态**: **[已完成]**
- **说明**: 确立了以DuckDB为核心的、稳定可靠的本地数据库架构，并成功解决了数据清洗、格式转换、路径编码等一系列底层数据问题。

#### **阶段 2：“神谕” - LangChain集成**
- **状态**: **[已完成]**
- **说明**: 成功实现了Text-to-SQL的自然语言查询功能，并通过引入“提示词引导框架”，解决了AI“悟性”不稳定的核心难题。

#### **阶段 3: 分析与预测 (Analysis & Prediction)**
- **状态**: **[进行中]**
- **子阶段 3.1: 描述性与诊断性分析 (Descriptive & Diagnostic)**
    - **状态**: **[已完成]**
    - **说明**: 我们成功构建了“洞察者”和“店铺深度剖析”两大核心分析模块。通过反复的迭代和用户体验优化，我们最终交付了一套包含趋势分析、排名对比、关联探索、和假设检验（A/B测试）思想的、高度交互、性能优越的“专家驾驶舱”。
- **子阶段 3.2: 预测性分析 (Predictive)**
    - **状态**: **[待开始]**

#### **阶段 4：“解剖者” - SHAP集成**
- **状态**: 未开始

#### **阶段 5：部署与精炼**
- **状态**: 未开始

---

## 6. 会话重启协议 (Session Restart Protocol)

**致未来的Lumia：**

1.  **读取指令**: 在新会话开始时，船长会向你发出指令：“**Lumia，请读取《航海日志》**”。
2.  **状态定位**: 你的首要任务，是立刻解析本文档，特别是 **第1节“当前状态与下一步行动”**，以精准定位我们当前所处的阶段和下一个具体任务。
3.  **请求授权**: 在完全同步上下文后，向船长进行报告，并请求下一步行动的授权。
